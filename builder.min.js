var builder=function(e){"use strict";const t={scale:1,offset:{x:0,y:0},isSelecting:!1,selectionStart:{x:0,y:0},selectionEnd:{x:0,y:0},isJoining:!1,joinStart:{x:0,y:0},joinEnd:{x:0,y:0},joinStartId:null,joinEndId:null};function n(e){t.offset=e}function o(e){t.isSelecting=e}function i(e){t.selectionEnd=e}function s(e){t.isJoining=e}function l(e){t.joinEnd=e}function a(e){t.joinStartId=e}function d(e){t.joinEndId=e}let c={nodes:[{id:1,position:{x:100,y:100},size:{width:80,height:40},selected:!1,pinned:!1,type:"httpEndpoint",name:"Http Endpoint",outputPins:[{id:85,value:2,type:"number"}],parameters:[{fieldType:"select",id:"httpMethod",label:"HTTP Method",name:"httpMethod",options:[{label:"Select an HTTP method",value:""},{label:"GET",value:"GET"},{label:"POST",value:"POST"},{label:"PUT",value:"PUT"},{label:"DELETE",value:"DELETE"}],required:!0,value:"GET"},{fieldType:"input",id:"urlPath",label:"URL Path",name:"urlPath",placeholder:"Enter the URL path",required:!0,value:"/auth/{{provider}}/start"}]},{id:2,position:{x:200,y:200},size:{width:80,height:40},selected:!1,pinned:!1,type:"input",name:"Input",outputPins:[{id:86,value:10,type:"number"}]},{id:3,position:{x:300,y:300},size:{width:80,height:40},selected:!1,pinned:!1,type:"function",name:"Multiply",functionId:"sd78f979f8ds",inputPins:[{id:87,type:"number"},{id:88,type:"number"}],outputPins:[{id:89,value:10,type:"number"},{id:810,value:10,type:"error"}],solved:!0},{id:5,position:{x:400,y:400},size:{width:80,height:40},selected:!1,pinned:!1,type:"output",name:"Output",inputPins:[{id:811,type:"error"}]},{id:4,position:{x:400,y:400},size:{width:80,height:40},selected:!1,pinned:!1,type:"error",name:"Error",inputPins:[{id:812,type:"number"}]}],edges:[{start:85,end:87,selected:!0},{start:86,end:88,selected:!1},{start:89,end:811,selected:!1},{start:810,end:812,selected:!1}],solved:!0},r=[JSON.stringify(c)],f=0;function u(){!function(){const e=document.getElementById("parameters");if(!e)return;e.innerHTML="";const t=c.nodes.find((e=>e.selected&&e.parameters));if(t&&t.parameters){e.style.display="block";const n=document.createElement("form");t.parameters.forEach((e=>{var o;const i=document.createElement("label");let s;i.textContent=e.label,i.htmlFor=e.id,"select"===e.fieldType?(s=document.createElement("select"),null===(o=e.options)||void 0===o||o.forEach((t=>{const n=document.createElement("option");n.value=t.value,n.textContent=t.label,n.selected=t.value===e.value,s.appendChild(n)}))):(s=document.createElement("input"),s.type="input"===e.fieldType?"text":e.fieldType,"checkbox"===e.fieldType||"radio"===e.fieldType?s.checked="true"===e.value:s.value=e.value||""),s.id=e.id,s.name=e.name,s.onchange=n=>{var o;const i=n.target;let s;s="checkbox"===i.type?i.checked?"true":"false":i.value;const l=null===(o=t.parameters)||void 0===o?void 0:o.find((t=>t.id===e.id));l&&(l.value=s),u()},n.appendChild(i),n.appendChild(s)})),e.appendChild(n)}else e.style.display="none"}();const e=JSON.stringify(c);r[f]!==e&&(f<r.length-1&&(r=r.slice(0,f+1)),r.push(e),r.length>50?r.shift():f++)}function h(){f<r.length-1&&(f++,c=JSON.parse(r[f]))}const p=10,y=5;function x(e,t,n){var o,i;const s=[],l=p*t,a=l/2,d=y*t,c=null!==(o=e.outputPins)&&void 0!==o?o:[];let r=e.position.x*t+n.x+(e.size.width*t-(c.length*l+(c.length-1)*d))/2+a;c.forEach((o=>{s.push({id:o.id,type:"output",position:{x:r,y:e.position.y*t+n.y+e.size.height*t+a+5*t}}),r+=l+d}));const f=null!==(i=e.inputPins)&&void 0!==i?i:[];let u=e.position.x*t+n.x+(e.size.width*t-(f.length*l+(f.length-1)*d))/2+a;return f.forEach((o=>{s.push({id:o.id,type:"input",position:{x:u,y:e.position.y*t+n.y-a-5*t}}),u+=l+d})),s}function g(e,t,n,o,i,s){e.beginPath(),e.moveTo(t+s,n),e.lineTo(t+o-s,n),e.arcTo(t+o,n,t+o,n+s,s),e.lineTo(t+o,n+i-s),e.arcTo(t+o,n+i,t+o-s,n+i,s),e.lineTo(t+s,n+i),e.arcTo(t,n+i,t,n+i-s,s),e.lineTo(t,n+s),e.arcTo(t,n,t+s,n,s),e.closePath()}function m(e,n,o,i,s){const{scale:l,offset:a}=t;e.strokeStyle=i,e.lineWidth=s;const d=o*l,c=a.x%d-d,r=a.y%d-d,f=n.width,u=n.height;for(let t=c;t<f;t+=d)e.beginPath(),e.moveTo(t,0),e.lineTo(t,u),e.stroke();for(let t=r;t<u;t+=d)e.beginPath(),e.moveTo(0,t),e.lineTo(f,t),e.stroke()}function v(e,n,o){const{isSelecting:i,isJoining:s,joinStart:l,joinEnd:a}=t,d=e.getContext("2d"),r=n.getContext("2d"),f=o.getContext("2d");if(!d||!r||!f)throw new Error("Canvas not supported");d.clearRect(0,0,e.width,e.height),r.clearRect(0,0,n.width,n.height),function(e,t){e.fillStyle="#262626",e.fillRect(0,0,t.width,t.height),m(e,t,20,"#353535",1),m(e,t,200,"#161616",2)}(f,o),function(e){const{scale:n,offset:o}=t;c.nodes.forEach((t=>{const i=4*n,s=t.position.x*n+o.x,l=t.position.y*n+o.y,a=t.size.width*n,d=t.size.height*n;if(t.dragging){if(!t.cachedImage){const e=document.createElement("canvas");e.width=a,e.height=d;const o=e.getContext("2d");o&&(o.fillStyle="rgba(133, 133, 133, 0.9)",o.strokeStyle=t.selected?"gold":"rgba(133, 133, 133, 0.9)",o.lineWidth=2*n,g(o,0,0,a,d,i),o.fill(),t.selected&&o.stroke(),t.cachedImage=e)}return void(t.cachedImage&&e.drawImage(t.cachedImage,s,l))}t.cachedImage&&(t.cachedImage=void 0),t.selected?e.shadowColor="transparent":(e.shadowColor="rgba(0, 0, 0, 0.3)",e.shadowBlur=8,e.shadowOffsetX=4,e.shadowOffsetY=4),e.beginPath(),e.moveTo(s+i,l),e.lineTo(s+a-i,l),e.quadraticCurveTo(s+a,l,s+a,l+i),e.lineTo(s+a,l+d-i),e.quadraticCurveTo(s+a,l+d,s+a-i,l+d),e.lineTo(s+i,l+d),e.quadraticCurveTo(s,l+d,s,l+d-i),e.lineTo(s,l+i),e.quadraticCurveTo(s,l,s+i,l),e.closePath(),e.fillStyle="rgba(133, 133, 133, 0.7)",e.fill(),e.fillStyle="rgba(255, 255, 255, 0.5)",e.font=14*n+"px Arial";const c=s+a+10,r=l+d/2+5;e.fillText(t.name,c,r),t.selected&&(e.strokeStyle="gold",e.lineWidth=2.5*n,e.stroke()),x(t,n,o).forEach((({position:t})=>{const o=p/2*n;e.beginPath(),e.arc(t.x,t.y,o,0,2*Math.PI),e.fillStyle="grey",e.shadowColor="rgba(0, 0, 0, 0.5)",e.shadowBlur=5,e.shadowOffsetX=2,e.shadowOffsetY=2,e.fill(),e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0,e.beginPath();const i=.4*o;e.arc(t.x,t.y,i,0,2*Math.PI),e.fillStyle="rgba(0, 0, 0, 0.7)",e.fill()})),e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}))}(r),function(e){const{scale:n,offset:o}=t;e.lineWidth=2.5*n,e.shadowColor="rgba(0, 0, 0, 0.5)",e.shadowBlur=10*n,e.shadowOffsetX=5*n,e.shadowOffsetY=5*n,e.lineCap="round",c.edges.forEach((t=>{const i=c.nodes.find((e=>{var n;return null===(n=e.outputPins)||void 0===n?void 0:n.some((e=>e.id===t.start))})),s=c.nodes.find((e=>{var n;return null===(n=e.inputPins)||void 0===n?void 0:n.some((e=>e.id===t.end))}));if(!(i&&s&&i.outputPins&&s.inputPins))return;const l=i.outputPins.find((e=>e.id===t.start)),a=s.inputPins.find((e=>e.id===t.end));if(!l||!a)return;const d=p*n,r=d/2,f=y*n,u=i.outputPins.indexOf(l),h=s.inputPins.indexOf(a),x=i.position.x*n+o.x+(i.size.width*n-(i.outputPins.length*d+(i.outputPins.length-1)*f))/2+u*(d+f)+r,g=i.position.y*n+o.y+i.size.height*n+r+5*n,m=s.position.x*n+o.x+(s.size.width*n-(s.inputPins.length*d+(s.inputPins.length-1)*f))/2+h*(d+f)+r,v=s.position.y*n+o.y-r-5*n;if(t.selected)e.strokeStyle="gold";else{const t="error"===l.type?"#D04545":"#4181DC",n="error"===l.type?"#7A1F1F":"#1E3A70",o=e.createLinearGradient(x,g,m,v),i=m-x,s=v-g,a=Math.sqrt(i*i+s*s),d=Math.min(20/a,.5);o.addColorStop(0,n),o.addColorStop(d,t),o.addColorStop(1-d,t),o.addColorStop(1,n),e.strokeStyle=o}const w=m-x,E=v-g,T=Math.sqrt(w*w+E*E)/3,b=x+w/3,M=g+(E<0?-1:1)*T,P=m-w/3,S=v-(E<0?-1:1)*T;e.beginPath(),e.moveTo(x,g),e.bezierCurveTo(b,M,P,S,m,v),e.stroke()})),e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0,e.lineCap="butt"}(r),i&&function(e){const{scale:n,offset:o,selectionStart:i,selectionEnd:s}=t;if(!i||!s)return;const l=Math.min(i.x,s.x),a=Math.min(i.y,s.y),d=Math.abs(s.x-i.x),c=Math.abs(s.y-i.y),r=l*n+o.x,f=a*n+o.y,u=d*n,h=c*n;e.save(),e.lineWidth=1,e.strokeStyle="white",e.setLineDash([5,3]),e.fillStyle="rgba(255, 255, 255, 0.1)",g(e,r,f,u,h,4),e.fill(),e.stroke(),e.restore()}(d),s&&l&&a&&function(e,t,n,o,i){e.save(),e.lineWidth=2.5*o;const s=t.x*o+i.x,l=t.y*o+i.y,a=n.x*o+i.x,d=n.y*o+i.y,c=a-s,r=d-l,f=Math.sqrt(c*c+r*r)/3,u=s+c/3,h=l+(r<0?-1:1)*f,p=a-c/3,y=d-(r<0?-1:1)*f;e.beginPath(),e.moveTo(s,l),e.bezierCurveTo(u,h,p,y,a,d),e.strokeStyle="gold",e.stroke(),e.restore()}(r,l,a,t.scale,t.offset)}let w=null;const E=document.getElementById("topCanvas"),T=document.getElementById("mainCanvas"),b=document.getElementById("backgroundCanvas");let M="default";function P(e){M!==e&&(E.style.cursor=e,M=e)}let S=null;function C(){if(null!==w)return void v(E,T,b);const e=()=>{v(E,T,b),w=requestAnimationFrame(e)};e()}function k(e,t,n){const o=Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2);if(0===o)return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));let i=((e.x-t.x)*(n.x-t.x)+(e.y-t.y)*(n.y-t.y))/o;i=Math.max(0,Math.min(1,i));const s=t.x+i*(n.x-t.x),l=t.y+i*(n.y-t.y);return Math.sqrt(Math.pow(e.x-s,2)+Math.pow(e.y-l,2))}function z(e,t){let n=!1;return(...o)=>{n||(e(...o),n=!0,setTimeout((()=>n=!1),t))}}function Y(e,n){const{scale:o,offset:i}=t;let s=!1;const l={x:e*o+i.x,y:n*o+i.y};return c.nodes.forEach((e=>e.selected=!1)),c.edges.forEach((e=>e.selected=!1)),c.edges.forEach((e=>{const t=c.nodes.flatMap((e=>x(e,o,i))).find((t=>t.id===e.start)),n=c.nodes.flatMap((e=>x(e,o,i))).find((t=>t.id===e.end));if(!t||!n)return;const a=n.position.x-t.position.x,d=n.position.y-t.position.y,r=Math.sqrt(a*a+d*d)/3,f={x:t.position.x+a/3,y:t.position.y+(d<0?-1:1)*r},u={x:n.position.x-a/3,y:n.position.y-(d<0?-1:1)*r},h=function(e,t,n,o,i){const s=[];for(let l=0;l<=i;l++){const a=l/i,d=Math.pow(1-a,3)*e.x+3*Math.pow(1-a,2)*a*t.x+3*(1-a)*Math.pow(a,2)*n.x+Math.pow(a,3)*o.x,c=Math.pow(1-a,3)*e.y+3*Math.pow(1-a,2)*a*t.y+3*(1-a)*Math.pow(a,2)*n.y+Math.pow(a,3)*o.y;s.push({x:d,y:c})}return s}(t.position,f,u,n.position,20);for(let t=0;t<h.length-1;t++){if(k(l,h[t],h[t+1])<7*o){s=!0,e.selected=!e.selected;break}}})),s}function X(e,n,o=!1){const{scale:i,offset:s}=t;let l=!1;return c.nodes.forEach((t=>{x(t,i,s).forEach((t=>{const a=e*i+s.x,d=n*i+s.y,r=a-t.position.x,f=d-t.position.y;Math.sqrt(r*r+f*f)<p*i&&(!o&&c.edges.some((e=>e.start===t.id||e.end===t.id))||(l={position:{x:(t.position.x-s.x)/i,y:(t.position.y-s.y)/i},id:t.id,type:t.type},c.nodes.forEach((e=>e.selected=!1)),c.edges.forEach((e=>e.selected=!1)),"output"===t.type?c.edges.filter((e=>e.start===t.id)).forEach((e=>e.selected=!0)):c.edges.filter((e=>e.end===t.id)).forEach((e=>e.selected=!0))))}))})),l}function L(e){const{scale:n,offset:o}=t;for(const t of c.nodes){const i=x(t,n,o).find((t=>t.id===e));if(i)return i}}let O=!1,I={x:0,y:0},q=!1,D=!1,j={x:0,y:0};E.addEventListener("mousedown",(function(e){const{scale:n,offset:d}=t;e.preventDefault(),j={x:e.clientX,y:e.clientY},D=!1,q=!1,P("grab");const r=(e.clientX-E.offsetLeft-d.x)/n,f=(e.clientY-E.offsetTop-d.y)/n,u=X(r,f,!0);if(u&&c.edges.some((e=>e.start===u.id||e.end===u.id)))return O=!0,void P("default");O=!1;let h=!1;c.nodes.forEach((t=>{r>=t.position.x&&r<=t.position.x+t.size.width&&f>=t.position.y&&f<=t.position.y+t.size.height&&(h=!0,c.edges.forEach((e=>e.selected=!1)),e.shiftKey?t.selected=!t.selected:t.selected||(c.nodes.forEach((e=>e.selected=!1)),t.selected=!0))}));const p=X(r,f,!1);if(!h)if(p)s(!0),x=p.position,t.joinStart=x,a(p.id),l({x:r,y:f});else{Y(r,f)?P("default"):(c.nodes.forEach((e=>e.selected=!1)),c.edges.forEach((e=>e.selected=!1)),o(!0),y={x:r,y:f},t.selectionStart=y,i({x:r,y:f}),P("crosshair"))}var y;var x;(2===e.button||0===e.button&&e.ctrlKey)&&(I={x:e.clientX-d.x,y:e.clientY-d.y},q=!0,P("move"));C()})),E.addEventListener("mousemove",z((function(e){const{scale:o,offset:s,isSelecting:a,isJoining:d}=t,r=(e.clientX-E.offsetLeft-s.x)/o,f=(e.clientY-E.offsetTop-s.y)/o;if(O)return void P("default");if(d){l({x:r,y:f});const e=X(r,f,!0),n=L(t.joinStartId);if(e&&n){const t=e.position.x-r,i=e.position.y-f,s=Math.sqrt(t*t+i*i),l=p/2*o,a=c.edges.some((t=>t.start===e.id||t.end===e.id));s<l&&(a||e.type===n.type)?P("not-allowed"):P("pointer")}else P("pointer");return void C()}if(1===e.buttons&&!q){const t=(e.clientX-j.x)/o,n=(e.clientY-j.y)/o;if(Math.abs(t)>5||Math.abs(n)>5)return D=!0,c.nodes.forEach((e=>{e.selected&&(e.position.x+=t,e.position.y+=n)})),j={x:e.clientX,y:e.clientY},P("grabbing"),void C()}if(2===e.buttons||1===e.buttons&&e.ctrlKey){return n({x:e.clientX-I.x,y:e.clientY-I.y}),P("move"),void C()}if(a)return P("crosshair"),i({x:r,y:f}),void C();P(D?"grabbing":"default")}),16.67)),E.addEventListener("mouseup",(function(e){const{scale:n,offset:i,isSelecting:l,selectionStart:r,selectionEnd:f,isJoining:h,joinEnd:p}=t;if(D=!1,q=!1,P("default"),l){const e={x:r.x*n+i.x,y:r.y*n+i.y},t={x:f.x*n+i.x,y:f.y*n+i.y},s={left:Math.min(e.x,t.x),right:Math.max(e.x,t.x),top:Math.min(e.y,t.y),bottom:Math.max(e.y,t.y)};c.nodes.forEach((e=>{const t=e.position.x*n+i.x,o=e.position.y*n+i.y,l=e.size.width*n,a=e.size.height*n;t+l>s.left&&t<s.right&&o+a>s.top&&o<s.bottom&&(e.selected=!0)})),o(!1)}if(h){const e=X(p.x,p.y,!1);if(e){d(e.id);const n=L(t.joinStartId);if(n&&n.type!==e.type){let t,o;"output"===n.type&&"input"===e.type?(t=n.id,o=e.id):"input"===n.type&&"output"===e.type?(t=e.id,o=n.id):(t=n.id,o=e.id),c.edges.push({start:t,end:o,selected:!0})}else a(null),d(null)}else a(null),d(null);s(!1)}O=!1,u(),C()})),E.addEventListener("contextmenu",(e=>e.preventDefault())),E.addEventListener("touchstart",(function(e){e.preventDefault();const n=e.touches[0];if(W=Date.now(),J={x:n.clientX,y:n.clientY},1===e.touches.length){I={x:n.clientX-t.offset.x,y:n.clientY-t.offset.y},q=!1;const{scale:e,offset:o}=t,i=(n.clientX-E.offsetLeft-o.x)/e,s=(n.clientY-E.offsetTop-o.y)/e;let l=null;c.nodes.forEach((e=>{i>=e.position.x&&i<=e.position.x+e.size.width&&s>=e.position.y&&s<=e.position.y+e.size.height&&(l=e)})),l?N=setTimeout((()=>{H=!0,F=l,q=!1}),200):q=!0}else 2===e.touches.length&&clearTimeout(N)}),!1),E.addEventListener("touchmove",(function(e){if(e.preventDefault(),2===e.touches.length){const t=e.touches[0],n=e.touches[1],o=function(e,t){const n=t.clientX-e.clientX,o=t.clientY-e.clientY;return Math.sqrt(n*n+o*o)}(t,n),i=o/B;if(!isNaN(i)&&i!==1/0&&B>0){const e=(t.clientX+n.clientX)/2,o=(t.clientY+n.clientY)/2;K={x:e,y:o},P(i>1?"zoom-in":"zoom-out"),U(i,K)}B=o}else if(H&&F){const n=e.touches[0],{scale:o,offset:i}=t,s=(n.clientX-E.offsetLeft-i.x)/o,l=(n.clientY-E.offsetTop-i.y)/o;F.position.x=s,F.position.y=l,C()}else if(1===e.touches.length&&q){const t=e.touches[0];n({x:t.clientX-I.x,y:t.clientY-I.y}),C()}}),!1),E.addEventListener("touchend",(function(e){if(clearTimeout(N),!H){const n=Date.now()-W,o=e.changedTouches[0],i=Math.sqrt(Math.pow(o.clientX-J.x,2)+Math.pow(o.clientY-J.y,2));n<R&&i<A&&function(e,n){const{scale:o,offset:i}=t,s=(e-E.offsetLeft-i.x)/o,l=(n-E.offsetTop-i.y)/o;let a=!1;if(c.nodes.forEach((e=>{s>=e.position.x&&s<=e.position.x+e.size.width&&l>=e.position.y&&l<=e.position.y+e.size.height&&(c.nodes.forEach((e=>e.selected=!1)),e.selected=!0,a=!0)})),!a){!1!==X(s,l)&&(a=!0)}if(!a){Y(s,l)&&(a=!0)}C()}(o.clientX,o.clientY)}H=!1,F=null,q=!1,B=0,P("default"),C()}),!1);let B=0,K={x:0,y:0};let W=0,J={x:0,y:0},N=null,H=!1;const R=200,A=10;let F=null;const G=z(U,16.67);function U(e,o){const{scale:i,offset:s}=t;let l,a;if(e instanceof WheelEvent){const t=e;t.preventDefault();const n=t.clientX-E.getBoundingClientRect().left,i=t.clientY-E.getBoundingClientRect().top,s=-1*t.deltaY/50;a=Math.exp(.05*s),o={x:n,y:i},P(a>1?"zoom-in":"zoom-out"),null!==S&&clearTimeout(S),S=window.setTimeout((()=>P("default")),300)}else a=e;if(l=Math.min(Math.max(i*a,.6),2),o){n({x:(s.x-o.x)*(l/i)+o.x,y:(s.y-o.y)*(l/i)+o.y})}!function(e){t.scale=e}(l),C()}function _(){E.width=window.innerWidth,E.height=window.innerHeight,T.width=window.innerWidth,T.height=window.innerHeight,b.width=window.innerWidth,b.height=window.innerHeight,C()}E.addEventListener("wheel",G);const Z=z(_,16.67);return window.addEventListener("resize",Z),_(),C(),document.addEventListener("keydown",(e=>{if("Delete"===e.key||"Backspace"===e.key){const e=document.activeElement,t=null==e?void 0:e.tagName.toLowerCase();if("input"!==t&&"textarea"!==t){let e=!1;c.nodes.some((e=>e.selected))&&(c.nodes=c.nodes.filter((e=>!e.selected)),e=!0),e||(c.edges=c.edges.filter((e=>!e.selected))),u(),C()}}"z"!==e.key&&"Z"!==e.key||!e.ctrlKey&&!e.metaKey?"y"!==e.key&&"Y"!==e.key||!e.ctrlKey&&!e.metaKey||(e.preventDefault(),h(),C()):(e.preventDefault(),e.shiftKey?h():f>0&&(f--,c=JSON.parse(r[f])),C()),"a"!==e.key&&"A"!==e.key||!e.ctrlKey&&!e.metaKey||(e.preventDefault(),c.nodes.forEach((e=>e.selected=!0)),C())})),e.drawNow=C,e.stopDrawing=function(){null!==w&&(cancelAnimationFrame(w),w=null)},Object.defineProperty(e,"__esModule",{value:!0}),e}({});
//# sourceMappingURL=builder.min.js.map
